"use strict";(self.webpackChunklego_front_devpn=self.webpackChunklego_front_devpn||[]).push([[5481],{98354:(e,s,n)=>{n.d(s,{Z:()=>r});var i=n(86010);const t={card:"card_D5QJ",head:"head__dCx",body:"body_BFWu"};var a=n(34410),l=n(85893);function r(e){let{title:s,extra:n,headStyle:r,bodyStyle:c,style:o,loading:d,children:h,className:m}=e;return(0,l.jsxs)("div",{className:(0,i.Z)(t.card,m),style:o,children:[s||n?(0,l.jsxs)("div",{className:(0,i.Z)("space-bt",t.head),style:r,children:[(0,l.jsx)("h3",{children:s}),(0,l.jsx)("div",{children:n})]}):null,(0,l.jsx)("div",{className:t.body,style:c,children:d?(0,l.jsx)(a.Z,{}):h})]})}},15330:(e,s,n)=>{n.r(s),n.d(s,{default:()=>O});var i=n(16550),t=n(42590),a=n(62813),l=n(96074),r=n(7442),c=n(24599),o=n(21032),d=n(7134),h=n(2058),m=n(15867),u=n(9146),p=n(67294),x=n(87547),j=n(88484),g=n(26594),f=n(85893);function k(){const[e,s]=(0,p.useState)(!1),{userInfo:n,setUserInfo:i,updateUserInfo:a}=(0,t.Pc)(),{message:l}=(0,r.S)();return(0,f.jsxs)("div",{className:"space-vb",style:{alignItems:"center"},children:[(0,f.jsx)("strong",{children:n?.name}),(0,f.jsx)(d.C,{size:128,icon:(0,f.jsx)(x.Z,{}),src:(0,g.Fq)(n)}),(0,f.jsx)(u.Z,{modalTitle:"\u7f16\u8f91\u5934\u50cf",children:(0,f.jsx)(h.Z,{accept:"image/jpg,image/jpeg,image/png",showUploadList:!1,customRequest:async e=>{const n=o.A.conn().token();if(!n)return void l.warning("\u4f1a\u8bdd\u8d85\u65f6\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55");s(!0);const i=e.file,t=`${await o.A.conn().url()}/up/image/${i.name}`,r=new XMLHttpRequest;r.open("POST",t),r.setRequestHeader("token",n),r.onreadystatechange=()=>{if(4==r.readyState)if(s(!1),200==r.status){const e=r.responseText;(0,c.Ii)(e).then((()=>{l.success("\u4fee\u6539\u7528\u6237\u5934\u50cf\u6210\u529f"),a()})).catch((e=>{l.error("\u4fdd\u5b58\u5934\u50cf\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5")}))}else l.error("\u4e0a\u4f20\u56fe\u7247\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5")},r.send(i)},children:(0,f.jsx)(m.ZP,{loading:e,icon:(0,f.jsx)(j.Z,{}),children:"\u4e0a\u4f20\u5934\u50cf"})})})]})}var y=n(37476),Z=n(5966),w=n(2487),C=n(59047);const v={light:"light_H9es"};function S(){const{userInfo:e,setUserInfo:s,setSuccess:n}=(0,t.Pc)(),[i,a]=(0,p.useState)(!1),[l,o]=(0,p.useState)(void 0),{message:d}=(0,r.S)(),[h,u]=(0,p.useState)(),[x,j]=(0,p.useState)(!1),k=async i=>{if(i.email&&!h){u(!0);try{const t=await(0,c.it)(i.email);"boolean"==typeof t?(e.email=i.email,e.email_check=!1,s({...e}),j(!1),n({duration:600,placement:"topRight",message:"\u53d1\u9001\u9a8c\u8bc1\u90ae\u4ef6\u6210\u529f",description:t?(0,f.jsxs)("div",{children:["\u606d\u559c\u60a8\uff0c\u9a8c\u8bc1\u90ae\u7bb1 ",(0,f.jsx)("strong",{children:i.email})," \u5c06\u5f97\u5230 7 \u5929 6G \u7684\u514d\u8d39\u5957\u9910"]}):(0,f.jsxs)("div",{children:["\u8bf7\u767b\u5f55 ",(0,f.jsx)("strong",{children:i.email})," \u9a8c\u8bc1\u90ae\u7bb1"]})})):"tempmail"==t?d.warning(`\u90ae\u7bb1 ${i.email} \u4f3c\u4e4e\u4e3a\u4e34\u65f6\u90ae\u7bb1\u5730\u5740\uff0c\u8bf7\u4f7f\u7528\u5176\u4ed6\u7684\u90ae\u7bb1\u5730\u5740`):"mailexist"==t?d.warning(`\u90ae\u7bb1 ${i.email} \u5df2\u7ecf\u5b58\u5728\uff0c\u8bf7\u4f7f\u7528\u5176\u4ed6\u7684\u90ae\u7bb1\u5730\u5740`):"maxcount"==t?d.error("\u91cd\u53d1\u9a8c\u8bc1\u90ae\u4ef6\u6b21\u6570\u8fc7\u591a\uff0c\u8bf724\u5c0f\u65f6\u540e\u518d\u8bd5"):d.error("\u672a\u77e5\u9519\u8bef\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5")}catch(t){d.error("\u51fa\u9519\u4e86\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5")}finally{u(!1)}}},[S,_]=(0,p.useState)(void 0),[P,b]=(0,p.useState)(!1),[q,I]=(0,p.useState)(!1),[N,M]=(0,p.useState)(void 0),O=()=>{b(!0),(0,c.kf)().then((e=>{_(e)})).finally((()=>{b(!1)}))},[$,F]=(0,p.useState)(!1);return(0,p.useEffect)(O,[]),(0,f.jsxs)("div",{children:[(0,f.jsx)(w.Z,{itemLayout:"horizontal",dataSource:[{title:"\u7528\u6237\u6635\u79f0",description:e.nickname?(0,f.jsxs)("div",{children:["\u5f53\u524d\u7684\u6635\u79f0\uff1a",(0,f.jsx)("strong",{className:v.light,children:e.nickname})]}):"\u8fd8\u6ca1\u6709\u8bbe\u7f6e\u7528\u6237\u6635\u79f0",actions:[(0,f.jsx)(m.ZP,{onClick:()=>{a(!0)},children:e.nickname?"\u4fee\u6539":"\u8bbe\u7f6e"},"Modify")]},{title:"\u7528\u6237\u90ae\u7bb1",description:e.email?e.email_check?(0,f.jsxs)("div",{children:["\u5df2\u7ed1\u5b9a\u90ae\u7bb1\uff1a",(0,f.jsx)("strong",{className:v.light,children:e.email})," ","\u5e76\u9a8c\u8bc1\ud83d\udc4d"]}):(0,f.jsxs)("div",{children:["\u8bf7\u767b\u5f55\u90ae\u7bb1"," ",(0,f.jsx)("strong",{className:v.light,children:e.email})," ","\u56de\u590d\u9a8c\u8bc1\u90ae\u4ef6\uff1b\u5982\u679c\u6ca1\u6709\u6536\u5230\u90ae\u4ef6\u8bf7\u68c0\u67e5\u5783\u573e\u7bb1\uff0c\u6216\u8005"," ",(0,f.jsx)(m.ZP,{loading:h,onClick:()=>{k(e)},children:"\u518d\u6b21\u53d1\u9001\u9a8c\u8bc1\u90ae\u4ef6"})]}):"\u8fd8\u6ca1\u6709\u7ed1\u5b9a\u90ae\u7bb1\uff0c\u5982\u679c\u6dfb\u52a0\u7684\u662f\u65b0\u90ae\u7bb1\uff0c\u5c06\u6709\u673a\u4f1a\u83b7\u53d6 7 \u5929 6G \u7684\u514d\u8d39\u5957\u9910",actions:[(0,f.jsx)(m.ZP,{loading:h,onClick:()=>{o(e),j(!0)},children:e?.email?"\u4fee\u6539":"\u8bbe\u7f6e"},"Modify")]},{title:"\u5bc6\u4fdd\u95ee\u9898",description:P?"...":S?.pwd_question?(0,f.jsxs)("div",{children:["\u5df2\u7ecf\u8bbe\u7f6e\u5bc6\u4fdd\u95ee\u9898\uff1a",(0,f.jsx)("strong",{className:v.light,children:S.pwd_question}),"\uff0c\u8bf7\u8bb0\u4f4f\u5bc6\u4fdd\u7b54\u6848"]}):"\u672a\u8bbe\u7f6e\u5bc6\u4fdd\u95ee\u9898\uff1a\u8bbe\u7f6e\u5bc6\u4fdd\u95ee\u9898\u53ef\u5e2e\u52a9\u60a8\u65b9\u4fbf\u627e\u56de\u5bc6\u7801\uff0c\u6709\u6548\u4fdd\u62a4\u8d26\u53f7\u5b89\u5168",actions:[(0,f.jsx)(m.ZP,{loading:P,onClick:()=>{M(S),I(!0)},children:S?.pwd_question?"\u4fee\u6539":"\u8bbe\u7f6e"},"Modify")]},{title:"\u4fee\u6539\u5bc6\u7801",description:"\u5b9a\u671f\u4fee\u6539\u5bc6\u7801\u53ef\u4ee5\u63d0\u9ad8\u767b\u5f55\u5b89\u5168\u6027",actions:[(0,f.jsx)(m.ZP,{onClick:()=>{F(!0)},children:"\u4fee\u6539"},"modify")]}],renderItem:e=>(0,f.jsx)(w.Z.Item,{actions:e.actions,children:(0,f.jsx)(w.Z.Item.Meta,{title:e.title,description:e.description})})}),(0,f.jsx)(y.Y,{title:"\u7f16\u8f91\u6635\u79f0",open:i,onFinish:async n=>{n.nickname&&(await(0,c.Q2)(n.nickname),e.nickname=n.nickname,s({...e}),a(!1),d.success("\u4fee\u6539\u7528\u6237\u6635\u79f0\u6210\u529f"))},initialValues:l,modalProps:{onCancel:()=>{a(!1)},destroyOnClose:!0,maskClosable:!1},children:(0,f.jsx)(Z.Z,{name:"nickname",label:"\u6635\u79f0",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6635\u79f0"},{pattern:/^\S[^\r\n]{0,120}\S$/,message:"\u6635\u79f0\u81f3\u5c11\u8981 2 \u4e2a\u5b57\u7b26\uff0c\u4e24\u7aef\u4e0d\u80fd\u6709\u7a7a\u683c"}],placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u6635\u79f0"})}),(0,f.jsxs)(y.Y,{title:"\u7f16\u8f91\u90ae\u7bb1",open:x,onFinish:k,initialValues:l,modalProps:{onCancel:()=>{j(!1)},destroyOnClose:!0,maskClosable:!1},children:[(0,f.jsx)(C.Z,{type:"warning",children:"\u4e3a\u4e86\u65b9\u4fbf\u60a8\u901a\u8fc7\u90ae\u7bb1\u627e\u56de\u5bc6\u7801\uff0c\u8bf7\u4e0d\u8981\u4f7f\u7528\u4e34\u65f6\u90ae\u7bb1\u5730\u5740\uff0c\u9700\u8981\u56de\u590d\u90ae\u4ef6\u9a8c\u8bc1\u90ae\u7bb1\u771f\u5b9e\u6027\u3002"}),e.email?null:(0,f.jsx)(C.Z,{type:"info",children:"\u5982\u679c\u60a8\u9996\u6b21\u6dfb\u52a0\u7684\u90ae\u7bb1\u6ca1\u6709\u5728\u5f53\u524d\u7cfb\u7edf\u4f7f\u7528\u8fc7\uff0c\u5c06\u4f1a\u8d60\u9001 7 \u5929 6G \u7684\u514d\u8d39\u5957\u9910\u7ed9\u60a8\u4f53\u9a8c\u3002"}),(0,f.jsx)(Z.Z,{name:"email",label:"\u90ae\u7bb1",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u90ae\u7bb1"},{type:"email",message:"\u8bf7\u8f93\u5165\u6709\u6548\u7684\u90ae\u7bb1"}],placeholder:"\u8bf7\u8f93\u5165\u90ae\u7bb1"})]}),(0,f.jsxs)(y.Y,{title:"\u4fee\u6539\u5bc6\u7801",open:$,onFinish:async e=>{delete e.confirm;try{await(0,c.pt)(e),d.success("\u4fee\u6539\u5bc6\u7801\u6210\u529f\uff0c\u8bf7\u8bb0\u4f4f\u65b0\u5bc6\u7801"),F(!1);const s=g.tO.get(g.VD.login);s&&(s.pwd=e.new_pwd,g.tO.set(g.VD.login,s))}catch(s){d.error("\u8bf7\u68c0\u67e5\u5bc6\u7801\u662f\u5426\u8f93\u5165\u6b63\u786e")}},modalProps:{onCancel:()=>{F(!1)},destroyOnClose:!0,maskClosable:!1},children:[(0,f.jsx)(Z.Z.Password,{name:"pwd",label:"\u767b\u5f55\u5bc6\u7801",placeholder:"\u8bf7\u8f93\u5165\u767b\u5f55\u5bc6\u7801",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u767b\u5f55\u5bc6\u7801"}]}),(0,f.jsx)(Z.Z.Password,{name:"new_pwd",dependencies:["pwd"],label:"\u65b0\u767b\u5f55\u5bc6\u7801",placeholder:"\u8bf7\u8f93\u5165\u65b0\u767b\u5f55\u5bc6\u7801",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u65b0\u767b\u5f55\u5bc6\u7801"},{min:6,message:"\u81f3\u5c116\u4f4d\u5bc6\u7801\uff0c\u533a\u5206\u5927\u5c0f"}]}),(0,f.jsx)(Z.Z.Password,{name:"confirm",dependencies:["new_pwd"],placeholder:"\u786e\u8ba4\u65b0\u5bc6\u7801",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u786e\u8ba4\u65b0\u5bc6\u7801"},e=>{let{getFieldValue:s}=e;return{validator:(e,n)=>n&&s("new_pwd")!==n?Promise.reject(new Error("\u4e24\u6b21\u8f93\u5165\u5bc6\u7801\u4e0d\u4e00\u81f4")):Promise.resolve()}}]})]}),(0,f.jsxs)(y.Y,{title:"\u7f16\u8f91\u7528\u6237\u5bc6\u4fdd",open:q,onFinish:async e=>{if(e.pwd_question){try{return await(0,c.M)(e),d.success("\u4fee\u6539\u7528\u6237\u5bc6\u4fdd\u6210\u529f"),O(),void I(!1)}catch(s){}d.error("\u8bf7\u68c0\u67e5\u5bc6\u7801\u662f\u5426\u8f93\u5165\u6b63\u786e")}},initialValues:N,modalProps:{onCancel:()=>{I(!1)},destroyOnClose:!0,maskClosable:!1},children:[(0,f.jsx)(Z.Z,{name:"pwd_question",label:"\u63d0\u793a\u95ee\u9898",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u63d0\u793a\u95ee\u9898"},{pattern:/^\S[^\r\n]{0,120}\S$/,message:"\u63d0\u793a\u95ee\u9898\u81f3\u5c11\u8981 2 \u4e2a\u5b57\u7b26\uff0c\u4e24\u7aef\u4e0d\u80fd\u6709\u7a7a\u683c"}],placeholder:"\u8bf7\u8f93\u5165\u63d0\u793a\u95ee\u9898"}),(0,f.jsx)(Z.Z,{name:"pwd_answer",label:"\u95ee\u9898\u7b54\u6848",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u95ee\u9898\u7b54\u6848"},{pattern:/^\S[^\r\n]{3,120}\S$/,message:"\u95ee\u9898\u7b54\u6848\u81f3\u5c11\u8981 5 \u4e2a\u5b57\u7b26\uff0c \u533a\u5206\u5927\u5c0f\u5199\uff0c\u4e24\u7aef\u4e0d\u80fd\u6709\u7a7a\u683c"}],placeholder:"\u8bf7\u8f93\u5165\u95ee\u9898\u7b54\u6848"}),S?.pwd_question?(0,f.jsx)(Z.Z.Password,{name:"pwd",label:"\u767b\u5f55\u5bc6\u7801",placeholder:"\u8bf7\u8f93\u5165\u767b\u5f55\u5bc6\u7801",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u767b\u5f55\u5bc6\u7801"}]}):null]})]})}var _=n(72269);function P(){const{userInfo:e,setUserInfo:s}=(0,t.Pc)(),{message:n}=(0,r.S)();return(0,f.jsx)(w.Z,{itemLayout:"horizontal",dataSource:[{title:"\u53cd\u9988\u63d0\u9192",description:"\u5f53\u5ba2\u670d\u56de\u590d\u60a8\u53cd\u9988\u7684\u95ee\u9898\uff0c\u6216\u8005\u5ba2\u670d\u4e3b\u52a8\u8054\u7cfb\u60a8\u65f6\uff0c\u5c06\u901a\u77e5\u63d0\u9192",actions:[(0,f.jsx)(_.Z,{checkedChildren:"\u5f00",unCheckedChildren:"\u5173",defaultChecked:e.mail_ticket,onChange:i=>{(0,c.PM)(i).then((()=>{e.mail_ticket=i,s({...e})})).catch((()=>{n.error("\u8bbe\u7f6e\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5")}))}},1)]},{title:"\u5957\u9910\u63d0\u9192",description:"\u5f53\u7cfb\u7edf\u81ea\u52a8\u5207\u6362\u5957\u9910\u6216\u8005\u81ea\u52a8\u7eed\u8d39\u65f6\u63d0\u9192\uff0c\u5305\u62ec\u4f59\u989d\u4e0d\u8db3\u800c\u81ea\u52a8\u505c\u6b62\u670d\u52a1\u7684\u63d0\u9192",actions:[(0,f.jsx)(_.Z,{checkedChildren:"\u5f00",unCheckedChildren:"\u5173",defaultChecked:e.mail_combo,onChange:i=>{(0,c.MY)(i).then((()=>{e.mail_combo=i,s({...e})})).catch((()=>{n.error("\u8bbe\u7f6e\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5")}))}},1)]},{title:"\u6d88\u606f\u63d0\u9192",description:"\u5305\u62ec\u7f51\u7ad9\u56e0\u67d0\u79cd\u539f\u56e0\u4e0d\u80fd\u6b63\u5e38\u8bbf\u95ee\u800c\u66f4\u6362\u57df\u540d\uff0c\u670d\u52a1\u5668\u66f4\u65b0\u7b49\u6709\u5173\u60a8\u6743\u5229\u7684\u901a\u77e5",actions:[(0,f.jsx)(_.Z,{checkedChildren:"\u5f00",unCheckedChildren:"\u5173",defaultChecked:e.mail_info,onChange:i=>{(0,c.tz)(i).then((()=>{e.mail_info=i,s({...e})})).catch((()=>{n.error("\u8bbe\u7f6e\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5")}))}},2)]}],renderItem:e=>(0,f.jsx)(w.Z.Item,{actions:e.actions,children:(0,f.jsx)(w.Z.Item.Meta,{title:e.title,description:e.description})})})}var b=n(85576),q=n(84567);function I(){const{userInfo:e,logout:s}=(0,t.Pc)(),[n,i]=(0,p.useState)(!1),[a,l]=(0,p.useState)(!1),{message:o}=(0,r.S)();return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(m.ZP,{type:"dashed",danger:!0,onClick:()=>{i(!1),l(!0)},children:"\u5220\u9664\u8d26\u53f7"}),(0,f.jsx)(b.Z,{title:`\u786e\u8ba4\u8981\u5220\u9664\u8d26\u53f7 ${e.name}`,okType:"danger",okButtonProps:{disabled:!n},destroyOnClose:!0,open:a,onCancel:()=>l(!1),onOk:()=>{l(!1),(0,c.h8)().then((()=>{o.success("\u5220\u9664\u6210\u529f\uff0c\u6b22\u8fce\u60a8\u518d\u6b21\u6ce8\u518c\u4f7f\u7528"),(0,g.yQ)(),s()})).catch((()=>{o.error("\u5220\u9664\u7528\u6237\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5")}))},children:(0,f.jsx)(q.Z,{checked:n,onChange:()=>i(!n),children:"\u5220\u9664\u540e\u65e0\u6cd5\u6062\u590d\uff0c\u8d26\u53f7\u4f59\u989d\u5c06\u6e05\u96f6\uff0c\u5957\u9910\u5c06\u5931\u6548\uff0c\u786e\u8ba4\u5220\u9664\u5417\uff1f"})})]})}var N=n(98354),M=n(34410);function O(){const{userInfo:e,inited:s}=(0,t.Pc)();return s?e&&e.name?(0,f.jsx)(a.Z,{title:`${e.nickname??e.name} \u7684\u4e2a\u4eba\u8bbe\u7f6e`,children:(0,f.jsx)("main",{children:(0,f.jsxs)("div",{className:"container contain-margin",children:[e.free||e.email?null:(0,f.jsx)(C.Z,{type:"warning",children:(0,f.jsx)("p",{children:"\u8fd8\u6ca1\u6709\u586b\u5199\u90ae\u7bb1\u5730\u5740\uff0c\u6dfb\u52a0\u90ae\u7bb1\u6709\u52a9\u4e8e\u65b9\u4fbf\u627e\u56de\u5bc6\u7801\uff0c\u8fd8\u6709\u673a\u4f1a\u83b7\u53d6 7 \u5929 6G \u7684\u514d\u8d39\u5957\u9910\u3002"})}),e.free?(0,f.jsx)(C.Z,{type:"warning",children:(0,f.jsx)("p",{children:"\u8bd5\u7528\u7528\u6237\u65e0\u6cd5\u4fee\u6539\u4e2a\u4eba\u8bbe\u7f6e\uff0c\u8bf7\u9000\u51fa\u767b\u5f55\u5e76\u6ce8\u518c\u5c5e\u4e8e\u60a8\u81ea\u5df1\u7684\u8d26\u53f7\u3002"})}):(0,f.jsxs)(N.Z,{children:[(0,f.jsx)(k,{}),(0,f.jsx)(S,{}),(0,f.jsx)(l.Z,{plain:!0,children:"\u63d0\u9192\u8bbe\u7f6e\uff08\u4ec5\u5bf9\u9a8c\u8bc1\u901a\u8fc7\u7684\u90ae\u7bb1\u751f\u6548\uff09"}),(0,f.jsx)(P,{}),(0,f.jsx)(l.Z,{plain:!0,children:"\u5220\u9664\u8d26\u53f7\uff08\u786e\u8ba4\u4e0d\u518d\u9700\u8981\u8fd9\u4e2a\u8d26\u53f7\uff09"}),(0,f.jsx)(I,{})]})]})})}):(0,f.jsx)(i.l_,{to:"/user/login"}):(0,f.jsx)(M.Z,{})}}}]);